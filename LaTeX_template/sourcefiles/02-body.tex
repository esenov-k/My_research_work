\chapter{Мультиобъектный трекинг (МОТ)}

Мультиобъектный трекинг (MOT) — это процесс идентификации и отслеживания нескольких объектов в пространстве и времени, при помощи компьютерного зрения. MOT важен для понимания и анализа сложных сцен, где множество объектов взаимодействуют друг с другом, и он находит применение во многих областях, включая видеонаблюдение, робототехнику и, конечно же, автономные транспортные средства.

В соответствии с SAE J3016 существует 6 уровней автоматизации автономных автомобилей~\cite{Steckhan2022}:

\begin{itemize}

	\item 	0 уровень --- отсутствие автоматизации. На данном уровне управление автомобилем осуществляется исключительно водителем;

	\item 	1 уровень --- помощь водителю. В системах первого уровня часть функций управления автомобиля осуществляет автоматика, при этом водитель постоянно находится в готовности взять полное управление автомобилем на себя;
	
	\item	2 уровень --- частичная автоматизация. В таких системах автоматика полностью управляет автомобилем в ряде ситуаций, при этом водитель находится в готовности взять управление на себя в случае, если система не справляется;
	
	\item	3 уровень --- условная автоматизация. При определенных обстоятельствах система может сама выполнять все функции управления, но водитель все ещё должен быть готов взять на себя управление, когда система не способна выполнять свои функции;
	
	\item 	4 уровень --- высокая автоматизация. ТС может двигаться самостоятельно почти во всех ситуациях, но нестандартные дорожные ситуации или другие внешние факторы могут потребовать вмешательства человека, при этом человек может сидеть в пассажирском кресле;
	
	\item 	5 уровень --- полная автоматизация. ТС способно выполнять все функции управления в любых обстоятельствах без человеческого вмешательства.

\end{itemize}

МОТ может быть применим ко всем уровням автономности, кроме нулевого, в той или иной степени. Например, для уровней с первого по второй MOT может использоваться для функций, таких как адаптивный круиз-контроль и предотвращение столкновений, а уже для уровней с третьего и выше, MOT является критически важной составляющей, обеспечивающей осведомленность систем автомобиля о динамической дорожной обстановке.


\section{Категоризация МОТ}

В виду того, что МОТ является довольной комплексной областью исследования, разделение на группы является достаточно сложной задачей. Категоризация на следующие группы является наиболее универсальной, так как охватывает основные черты МОТ~\cite{Article::Luo2021}: 

\begin{enumerate}

	\item Категоризация по методу инициализации: 
		
	\begin{itemize}
		
		\item Detection-Based Tracking (DBT)~\cite{Bose2007, Song2010}: Объекты сначала обнаруживаются, а затем связываются в траектории. Этот метод фокусируется на конкретных типах целей, таких как пешеходы, транспортные средства или лица;
		
		\item Detection-Free Tracking (DFT)~\cite{Zhang2013}: Требует ручной инициализации фиксированного количества объектов в первом кадре, затем локализует эти объекты в последующих кадрах.
	
	\end{itemize}
	
	\item Категоризация по режиму обработки:
	
	\begin{itemize}
		
		\item Online Tracking~\cite{Xiang2015}: Обрабатывает последовательность изображений пошагово, используя наблюдения, доступные до текущего момента;
		
		\item Offline Tracking: Использует пакет кадров для обработки данных, требует предварительного получения наблюдений со всех кадров.
		
	\end{itemize}
	
	\item Категоризация по типу вывода:
	
	\begin{itemize}
		
		\item Stochastic Tracking: Результаты варьируются от одного запуска к другому из-за случайности в процессе генерации частиц или других элементов;
		
		\item Deterministic Tracking: Результаты остаются постоянными при многократном запуске методов.
		
	\end{itemize}
	
\end{enumerate}

\section{Алгоритмы и метрики МОТ}
В зависимости от конечной задачи, алгоритмы МОТ могут отличаться. Так как МОТ планируется использовать в автономных автомобилях, системах помощи водителю на различных уровнях, то необходимо использовать отслеживание в реальном времени. Рассмотрим основные, наиболее популярные алгоритмы, которые для этого подходят~\cite{Article::Luo2021}:

\begin{itemize}
	
	\item Фильтр Калмана --- широко используется для предсказания положения и скорости объектов. Он предполагает, что движение объекта может быть аппроксимировано линейной моделью. С нелинейными моделями он менее эффективен~\cite{Rodriguez2011}.
	
	\item Расширенный фильтр Калмана --- позволяет работать с нелинейными моделями, что расширяет возможности его применения. В отличие от своего линейного аналога, расширенный фильтр Калмана в общем случае не является оптимальным средством оценки (он оптимален, если измерение и модель перехода состояния являются линейными, т.к. в этом случае расширенный фильтр Калмана идентичен обычному)~\cite{Mitzel2011, ExtendetKalmanFilter2023}. 
	
	\item Частотный фильтр --- нелинейная альтернатива Фильтру Калмана, использует "частицы" для представления возможных состояний объекта и обновляет их на основе наблюдений. Предлагает лучшую производительность для нелинейного движения, но требует больше вычислительных ресурсов~\cite{Yang2009}.

	
\end{itemize}

Для дальнейшего понимания, подходят ли те или иные алгоритмы, необходимо определить их преимущества и недостатки, конкретно под требуемую задачу. Для этого надо пользоваться метриками, указанными в таблице \ref{metrics}, которые покажут наглядно, в каких местах подходит выбранный алгоритм или нет.

\begin{table}[H]
	\centering
	\caption{Обзор метрик оценки для систем мультиобъектного трекинга (МОТ)}
	\label{metrics}
	\begin{tabularx}{\textwidth}{|X|X|}
		\hline
		Метрика & Описание\\ 
		\hline
		Полнота (Recall) & Доля правильно идентифицированных объектов среди всех реальных объектов \\
		\hline
		Точность (Precision) & Доля правильно идентифицированных объектов среди всех идентифицированных\\
		\hline
		Ложные срабатывания в кадре (False Alarms per Frame(FAF)) & Количество ложных тревог за кадр, усредненное по последовательности \\
		\hline
		Точность обнаружения нескольких объектов (Multiple Object Detection Accuracy (MODA)) & Комбинация пропущенных обнаружений и FAF \\
		\hline
		Точность обнаружения нескольких объектов (Multiple Object Detection Precision (MODP)) & Среднее перекрытие между истинными положительными и эталонными значениями \\
		\hline
		Точность трекинга нескольких объектов(Multiple Object Tracking Precision (MOTP)) & 
		Перекрытие между оцененными позициями и эталонной правдой, усредненное по сопоставлениям  \\ 
		\hline
		Точность трекинга нескольких объектов (Multiple Object Tracking Accuracy (MOTA)) & Комбинация ложных отрицательных, ложных положительных и ошибок сопоставления \\
		\hline
		ИДС (IDS) & Количество раз, когда отслеживаемая траектория меняет свой идентификатор \\
		\hline
	\end{tabularx}
\end{table}


\chapter{Применение МОТ в системах АКК и АЭТ}

\section{Адаптивный круиз-контроль}
Адаптивный круиз-контроль --- это продвинутая версия традиционного круиз-контроля, который не только поддерживает заданную скорость, но и автоматически регулирует скорость автомобиля для поддержания безопасного расстояния до впереди идущего автомобиля.

В основе работы простого АКК лежат следующие основные части: датчики, которые отвечают за определение расстояние впереди движущегося автомобиля, блок управления и исполнительные устройства (двигатель, КПП, тормозная система). В отличие от обычного круиз-контроля, адаптивный способен подстраиваться под окружающий трафик, ускоряя машину до заданной скорости, либо замедляя ее до скорости впереди идущего автомобиля, вплоть до полной остановки.

При введении МОТ в систему АКК, решается ряд следующих задач:

\begin{itemize}

	\item Обнаружение и отслеживание --- MOT используется для обнаружения и отслеживания положения и скорости транспортных средств впереди. Это достигается с помощью радаров, лидаров или камер, которые непрерывно анализируют дорожную обстановку.

	\item Принятие решений --- Система АКК получает данные от MOT и принимает решение о необходимости ускорения или торможения. Если расстояние до впереди идущего транспортного средства уменьшается, система автоматически снизит скорость, чтобы поддерживать безопасный интервал.

	\item Прогнозирование траекторий --- MOT также может помогать в прогнозировании траекторий движения окружающих транспортных средств, что позволяет системе АКК предвидеть возможные изменения в движении и заранее адаптироваться к ним.

\end{itemize}

За счет того, что в МОТ используются как камеры, так и лидары/радары, можно говорить о более точной работе системы АКК. Анализ окружающей среды при помощи МОТ и дальнейшей его обработка в блоке управления позволят улучшить параметры точности системы и сведут возможную ошибку к минимуму. 

\section{Автоматическое экстренное торможение}

Автоматическое экстренное торможение --- это система активной безопасности в автомобилях, которая определяет потенциальную опасную ситуацию и, путем автоматического применения тормозов, смягчает, либо полностью предотвращает их. 

Как и система АКК, АЭТ использует различные датчики, такие как радар, лидар и камеры, для мониторинга дорожной ситуации вокруг автомобиля. Если система обнаруживает потенциальную угрозу столкновения и водитель не реагирует должным образом, она автоматически активирует тормоза, чтобы либо полностью избежать столкновения, либо уменьшить силу удара при столкновении.

Введение МОТ позволит более точно и своевременно реагировать на потенциальные опасности на дороге. Вот основные аспекты применения МОТ в таких системах:

\begin{itemize}

	\item	Распознавание и отслеживание нескольких объектов --- МОТ позволяет системе одновременно отслеживать множество объектов, таких как другие транспортные средства, пешеходы, велосипедисты и препятствия на дороге, предоставляя комплексную картину дорожной ситуации.
	
	\item	Прогнозирование траекторий --- системы с МОТ способны анализировать и прогнозировать траектории движения отслеживаемых объектов, что помогает определить потенциальные риски столкновения и принять меры для их предотвращения.
	
	\item	Решение о торможении --- на основе полученных данных и прогнозов МОТ система может принимать решения о необходимости экстренного торможения, чтобы избежать столкновения или минимизировать его последствия.
	
\end{itemize}

Система АЭТ активно используется крупнейшими автомобильными компаниями, такими как Volvo~\cite{Volvo2009}, Tesla~\cite{Tesla2023}, Mercedes-Benz~\cite{MercedesBenz2021} и показывает хорошие результаты.

Как можно видеть, в системах АКК и АЭТ МОТ выполняет довольно схожие функции, что и является основной причиной применения данной технологии в системах помощи водителю. Таким образом, введение