\chapter{Мультиобъектный трекинг (МОТ)}

Мультиобъектный трекинг (MOT) — это процесс идентификации и отслеживания нескольких объектов в пространстве и времени, при помощи компьютерного зрения. MOT важен для понимания и анализа сложных сцен, где множество объектов взаимодействуют друг с другом, и он находит применение во многих областях, включая видеонаблюдение, робототехнику и, конечно же, автономные транспортные средства.

В соответствии с SAE J3016 существует 6 уровней автоматизации автономных автомобилей~\cite{Steckhan2022}:

\begin{itemize}

	\item 	0 уровень --- отсутствие автоматизации. На данном уровне управление автомобилем осуществляется исключительно водителем;

	\item 	1 уровень --- помощь водителю. В системах первого уровня часть функций управления автомобиля осуществляет автоматика, при этом водитель постоянно находится в готовности взять полное управление автомобилем на себя;
	
	\item	2 уровень --- частичная автоматизация. В таких системах автоматика полностью управляет автомобилем в ряде ситуаций, при этом водитель находится в готовности взять управление на себя в случае, если система не справляется;
	
	\item	3 уровень --- условная автоматизация. При определенных обстоятельствах система может сама выполнять все функции управления, но водитель все ещё должен быть готов взять на себя управление, когда система не способна выполнять свои функции;
	
	\item 	4 уровень --- высокая автоматизация. ТС может двигаться самостоятельно почти во всех ситуациях, но нестандартные дорожные ситуации или другие внешние факторы могут потребовать вмешательства человека, при этом человек может сидеть в пассажирском кресле;
	
	\item 	5 уровень --- полная автоматизация. ТС способно выполнять все функции управления в любых обстоятельствах без человеческого вмешательства.

\end{itemize}

МОТ может быть применим ко всем уровням автономности, кроме нулевого, в той или иной степени. Например, для уровней с первого по второй MOT может использоваться для функций, таких как адаптивный круиз-контроль и предотвращение столкновений, а уже для уровней с третьего и выше, MOT является критически важной составляющей, обеспечивающей осведомленность систем автомобиля о динамической дорожной обстановке.


\section{Категоризация МОТ}

В виду того, что МОТ является довольной комплексной областью исследования, разделение на группы является достаточно сложной задачей. Категоризация на следующие группы является наиболее универсальной, так как охватывает основные черты МОТ~\cite{Article::Luo2021}: 

\begin{enumerate}

	\item Категоризация по методу инициализации: 
		
	\begin{itemize}
		
		\item Слежение с обнаружением (Detection-Based Tracking (DBT))~\cite{Bose2007, Song2010}: Объекты сначала обнаруживаются, а затем связываются в траектории. Этот метод фокусируется на конкретных типах целей, таких как пешеходы, транспортные средства или лица;
		
		\item Слежение без обнаружения (Detection-Free Tracking (DFT))~\cite{Zhang2013}: Требует ручной инициализации фиксированного количества объектов в первом кадре, затем локализует эти объекты в последующих кадрах.
	
	\end{itemize}
	
	\item Категоризация по режиму обработки:
	
	\begin{itemize}
		
		\item Онлайн-отслеживание~\cite{Xiang2015}: Обрабатывает последовательность изображений пошагово, используя наблюдения, доступные до текущего момента;
		
		\item Оффлайн-отслеживание: Использует пакет кадров для обработки данных, требует предварительного получения наблюдений со всех кадров.
		
	\end{itemize}
	
	\item Категоризация по типу вывода:
	
	\begin{itemize}
		
		\item Стохастическое отслеживание: Результаты варьируются от одного запуска к другому из-за случайности в процессе генерации частиц или других элементов;
		
		\item Детерминированное отслеживание: Результаты остаются постоянными при многократном запуске методов.
		
	\end{itemize}
	
\end{enumerate}

Так как система МОТ будет использована в автономном транспорте, то нам необходимы алгоритмы слежения с обнаружением в онлайн режиме. Таким образом, надо подобрать такие системы детекции и трекинга, которые будут удовлетворять нашим требованиям.

\section{Методы детекции}

Проблема детекции объекта на изображении или видео, стоит давно. Современные технологии позволяют довольно точно определять что изображено на картинке или видео. Рассмотрим несколько популярных методов детекции и проведем сравнение.

\subsection{Метод градиентов (Histogram of Oriented Gradients(HOG))}

Метод градиентов появился в 2005 году Навнеетом Далалом и Биллом Триггсом. Данный способ заключается в том, что с помощью распределения градиентов интенсивности или направлений краев определяется форма объекта и его внешний вид. На изображениях \ref{fig::HOG_1} и \ref{fig::HOG_2} показано как распределяется градиент в изображении.

\img[htb]{fig::HOG_1}{HOG_1.png}{Распределение векторов градиента}{0.5}

\img[htb]{fig::HOG_2}{HOG_2.png}{Пример определения формы объекта при помощи HOG}{0.5}


Из плюсов можно выделить вычислительную эффективность: метод довольно эффективен и может быть реализован для работы в реальном времени на современном аппаратном обеспечении и имеет широкую область применения для задач обнаружения пешеходов, транспортных средств, лиц и других объектов. 

Однако у HOG есть ряд минусов, которые не позволяют его использовать для МОТ: игнорирование цвета, что не позволит различить объекты друг от друга, неустойчивость к изменению масштаба и ориентации объекта, чувствительность к шумам и плохая работа с динамическими сценами.  

\subsection{Сверточные нейронные сети (СНС)}

Сверточные нейронные сети --- это класс глубоких нейронных сетей, которые используются в компьютерном зрении для анализа визуальных данных. 

Благодаря своим алгоритмам, СНС способны распознавать объекты независимо от их положения в изображении, а также способны автоматически выявлять важные признаки без предварительного определения их в ручную. Но из-за высокой вычислительной сложности СНС требует значительных вычислительных ресурсов и большего количества времени на обработку изображения, что является критически важным фактором для МОТ. Долгая обработка не позволит использовать данный метод в реальном времени.

\subsection{Single Shot Detector (SSD)}

Single Shot Detector (SSD) --- это метод детекции объектов, используемый в компьютерном зрении для обнаружения множества объектов на изображении в один проход. Это делает данный способ особенно полезным для приложений в реальном времени, таких как видеонаблюдение или автономное вождение, где требуется быстрое и эффективное распознавание. Одним из главных преимуществ SSH является скорость. Благодаря своим алгоритмам, SSD может оценить сетку ограничивающих рамок и вероятности классов для этих рамок одновременно, что позволяет достичь скорости, которую можно использовать в реальном времени. Также, благодаря архитектуре, SSD проще в реализации и тренировке по сравнению с вышеперечисленными методами.

Несмотря на все преимущества, у SSD есть и ряд недостатков, таких как сложность работы с мелкими объектами и высокая степень ложных положительных срабатываний (особенно в сценах с сложным фоном).

SSD продолжает развиваться, и его варианты, такие как SSD300 (использующий входные изображения размером 300x300 пикселей) и SSD512 (использующий изображения размером 512x512), предлагают различные компромиссы между скоростью и точностью детекции.

\subsection{YOLO(You Only Look Once)}

YOLO или You Only Look Once --- алгоритм детекции объектов, схожий с SSD, также обрабатывает изображение только один раз. Однако, между ними есть ряд различий, таких как различие в архитектуре, скорости и точности. Различие в архитектуре определяет скорость. YOLO делит изображение на сетку, а затем использует набор фильтров, чтобы предсказать все рамки и классификации за один раз (рисунок \ref{fig::YOLO_1}). SSD также предсказывает ограничивающие рамки и классы объектов за один проход, но делает это, применяя серию сверточных фильтров различного размера к множеству признаковых карт, что позволяет обнаруживать объекты разного размера. Таким образом, YOLO более эффективен для обнаружения больших объектов, но может пропустить маленькие из-за фиксированного размера сетки, что не является критичным в рамках автономных автомобилей. 

\img[htb]{fig::YOLO_1}{YOLO_1.png}{Принцип работы YOLO}{0.7}

Одним из ключевых факторов это скорость. SSD уступают по скорости YOLO, которая способна обрабатывать от десятков до сотен кадров в секунду. 

Таким образом, после небольшого анализа и сравнения методов детекции, наиболее подходящим  в МОТ для автономных автомобилях является YOLO, благодаря своей высокой скорости и точности.



\section{Алгоритмы и метрики МОТ}
В зависимости от конечной задачи, алгоритмы МОТ могут отличаться. Как было упомянуто выше, нам  необходимы алгоритмы слежения с обнаружением в онлайн режиме. Рассмотрим основные, наиболее популярные алгоритмы МОТ, которые для этого подходят~\cite{Article::Luo2021}:

\begin{itemize}
	
	\item Фильтр Калмана --- широко используется для предсказания положения и скорости объектов. Он предполагает, что движение объекта может быть аппроксимировано линейной моделью. С нелинейными моделями он менее эффективен~\cite{Rodriguez2011}.
	
	\item Расширенный фильтр Калмана --- позволяет работать с нелинейными моделями, что расширяет возможности его применения. В отличие от своего линейного аналога, расширенный фильтр Калмана в общем случае не является оптимальным средством оценки (он оптимален, если измерение и модель перехода состояния являются линейными, т.к. в этом случае расширенный фильтр Калмана идентичен обычному)~\cite{Mitzel2011, ExtendetKalmanFilter2023}. 
	
	\item Частотный фильтр --- нелинейная альтернатива Фильтру Калмана, использует "частицы" для представления возможных состояний объекта и обновляет их на основе наблюдений. Предлагает лучшую производительность для нелинейного движения, но требует больше вычислительных ресурсов~\cite{Yang2009}.

	
\end{itemize}

Для дальнейшего понимания, подходят ли те или иные алгоритмы, необходимо определить их преимущества и недостатки, конкретно под требуемую задачу. Для этого надо пользоваться метриками, указанными в таблице \ref{metrics}, которые покажут наглядно, в каких местах подходит выбранный алгоритм или нет.

\begin{table}[H]
	\centering
	\caption{Обзор метрик оценки для систем мультиобъектного трекинга (МОТ)}
	\label{metrics}
	\begin{tabularx}{\textwidth}{|X|X|}
		\hline
		Метрика & Описание\\ 
		\hline
		Полнота (Recall) & Доля правильно идентифицированных объектов среди всех реальных объектов \\
		\hline
		Точность (Precision) & Доля правильно идентифицированных объектов среди всех идентифицированных\\
		\hline
		Ложные срабатывания в кадре (False Alarms per Frame(FAF)) & Количество ложных тревог за кадр, усредненное по последовательности \\
		\hline
		Точность обнаружения нескольких объектов (Multiple Object Detection Accuracy (MODA)) & Комбинация пропущенных обнаружений и FAF \\
		\hline
		Точность обнаружения нескольких объектов (Multiple Object Detection Precision (MODP)) & Среднее перекрытие между истинными положительными и эталонными значениями \\
		\hline
		Точность трекинга нескольких объектов(Multiple Object Tracking Precision (MOTP)) & 
		Перекрытие между оцененными позициями и эталонной правдой, усредненное по сопоставлениям  \\ 
		\hline
		Точность трекинга нескольких объектов (MultipleObject Tracking Accurac (MOTA)) & Комбинация ложных отрицательных, ложных положительных и ошибок сопоставления \\
		\hline
		Переключатель ID (ID Switch (IDS)) & Количество раз, когда отслеживаемая траектория меняет свой идентификатор \\
		\hline
	\end{tabularx}
\end{table}


\chapter{Применение МОТ в системах АКК и АЭТ}

\section{Адаптивный круиз-контроль}
Адаптивный круиз-контроль --- это продвинутая версия традиционного круиз-контроля, который не только поддерживает заданную скорость, но и автоматически регулирует скорость автомобиля для поддержания безопасного расстояния до впереди идущего автомобиля.

В основе работы простого АКК лежат следующие основные части: датчики, которые отвечают за определение расстояние впереди движущегося автомобиля, блок управления и исполнительные устройства (двигатель, КПП, тормозная система). В отличие от обычного круиз-контроля, адаптивный способен подстраиваться под окружающий трафик, ускоряя машину до заданной скорости, либо замедляя ее до скорости впереди идущего автомобиля, вплоть до полной остановки.

При введении МОТ в систему АКК, решается ряд следующих задач:

\begin{itemize}

	\item Обнаружение и отслеживание --- MOT используется для обнаружения и отслеживания положения и скорости транспортных средств впереди. Это достигается с помощью радаров, лидаров или камер, которые непрерывно анализируют дорожную обстановку.

	\item Принятие решений --- Система АКК получает данные от MOT и принимает решение о необходимости ускорения или торможения. Если расстояние до впереди идущего транспортного средства уменьшается, система автоматически снизит скорость, чтобы поддерживать безопасный интервал.

	\item Прогнозирование траекторий --- MOT также может помогать в прогнозировании траекторий движения окружающих транспортных средств, что позволяет системе АКК предвидеть возможные изменения в движении и заранее адаптироваться к ним.

\end{itemize}

За счет того, что в МОТ используются как камеры, так и лидары/радары, можно говорить о более точной работе системы АКК. Анализ окружающей среды при помощи МОТ и дальнейшей его обработка в блоке управления позволят улучшить параметры точности системы и сведут возможную ошибку к минимуму. 

\section{Автоматическое экстренное торможение}

Автоматическое экстренное торможение --- это система активной безопасности в автомобилях, которая определяет потенциальную опасную ситуацию и, путем автоматического применения тормозов, смягчает, либо полностью предотвращает их. 

Как и система АКК, АЭТ использует различные датчики, такие как радар, лидар и камеры, для мониторинга дорожной ситуации вокруг автомобиля. Если система обнаруживает потенциальную угрозу столкновения и водитель не реагирует должным образом, она автоматически активирует тормоза, чтобы либо полностью избежать столкновения, либо уменьшить силу удара при столкновении.

Введение МОТ позволит более точно и своевременно реагировать на потенциальные опасности на дороге. Вот основные аспекты применения МОТ в таких системах:

\begin{itemize}

	\item	Распознавание и отслеживание нескольких объектов --- МОТ позволяет системе одновременно отслеживать множество объектов, таких как другие транспортные средства, пешеходы, велосипедисты и препятствия на дороге, предоставляя комплексную картину дорожной ситуации.
	
	\item	Прогнозирование траекторий --- системы с МОТ способны анализировать и прогнозировать траектории движения отслеживаемых объектов, что помогает определить потенциальные риски столкновения и принять меры для их предотвращения.
	
	\item	Решение о торможении --- на основе полученных данных и прогнозов МОТ система может принимать решения о необходимости экстренного торможения, чтобы избежать столкновения или минимизировать его последствия.
	
\end{itemize}

Система АЭТ активно используется крупнейшими автомобильными компаниями, такими как Volvo~\cite{Volvo2009}, Tesla~\cite{Tesla2023}, Mercedes-Benz~\cite{MercedesBenz2021} и показывает хорошие результаты.

Как можно видеть, в системах АКК и АЭТ МОТ выполняет довольно схожие функции, что и является основной причиной применения данной технологии в системах помощи водителю. Таким образом, введение